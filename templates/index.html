<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì‹ ì²­ - 1ë‹¨ê³„</title>
  <link rel="stylesheet" href="../static/style_1.css">
  <link rel="stylesheet" href="../static/chat.css">
</head>
<body>
  <div class="page">
    <div class="main-card">

      <!-- ìƒë‹¨ í—¤ë” -->
      <div class="header">
        <h1>ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì‹ ì²­</h1>
        <p>í•„ìš”í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
      </div>

      <!-- ì§„í–‰ë¥  -->
      <div class="progress-section">
        <div class="progress-info">
          <span>ì§„í–‰ë¥ </span>
          <span class="step">1/3 ë‹¨ê³„</span>
        </div>

        <div class="progress-bar">
          <div class="bar-fill"></div>
        </div>

        <div class="step-tabs">
          <div class="tab active">ëŒ€ì¶œ ì •ë³´</div>
          <div class="tab">ë‹´ë³´ ì •ë³´</div>
          <div class="tab">ì†Œë“ ë° ìê²©</div>
        </div>
      </div>

      <!-- ì…ë ¥ ì˜ì—­ -->
      <div class="popup">

        <!-- ëŒ€ì¶œ í¬ë§ ê¸ˆì•¡ -->
        <div class="loan-amount">
          <label>ğŸª™ ëŒ€ì¶œ í¬ë§ ê¸ˆì•¡</label>
          <input id="loanAmount" type="number" placeholder="ì˜ˆ: 100,000,000">

          <div class="preset-amounts">
            <button type="button" onclick="setAmount(100000000)">1ì–µì›</button>
            <button type="button" onclick="setAmount(300000000)">3ì–µì›</button>
            <button type="button" onclick="setAmount(500000000)">5ì–µì›</button>
            <button type="button" onclick="setAmount(1000000000)">10ì–µì›</button>
          </div>
        </div>

        <!-- ìƒí™˜ê¸°ê°„ (ë“œë¡­ë‹¤ìš´) -->
        <div class="form-group">
          <label for="repaymentPeriod">ğŸ“… ìƒí™˜ ê¸°ê°„</label>
          <select id="repaymentPeriod" class="select-box">
            <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="10ë…„">10ë…„</option>
            <option value="15ë…„">15ë…„</option>
            <option value="20ë…„">20ë…„</option>
            <option value="30ë…„">30ë…„</option>
          </select>
        </div>

        <!-- ê¸ˆë¦¬ìœ í˜• -->
        <div class="rate-type">
            <label>ğŸ“‰ ê¸ˆë¦¬ ìœ í˜•</label>
            <div class="rate-options">
                <button type="button" data-value="ê³ ì •ê¸ˆë¦¬">
                    <span class="title">ê³ ì •ê¸ˆë¦¬</span>
                    <span class="subtitle">ê¸°ê°„ ë‚´ ê¸ˆë¦¬ ê³ ì •</span>
                </button>
                <button type="button"data-value="ë³€ë™ê¸ˆë¦¬">
                    <span class="title">ë³€ë™ê¸ˆë¦¬</span>
                    <span class="subtitle">ì‹œì¥ ê¸ˆë¦¬ì— ì—°ë™</span>
                </button>
                <button type="button" data-value="ëª¨ë¦„">
                    <span class="title">ì˜ ëª¨ë¥´ê² ì–´ìš”</span>
                    <span class="subtitle">ì¶”ì²œë°›ê¸°</span>
                </button>
            </div>
        </div>

        <!-- ë‹¤ìŒ ë²„íŠ¼ -->
        <div class="nav-buttons">
          <button class="btn-next" onclick="submitPage1()">ë‹¤ìŒ</button>
        </div>

        <!-- ì±—ë´‡ ë²„íŠ¼ -->
          <div class="help-hint">ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ ë§ì„ ê±¸ì–´ì£¼ì„¸ìš”</div>
        <div class="help-icon" id="chatBtn"></div>

        <!-- ì±—ë´‡ íŒì—… -->
        <div class="chat-panel" id="chatPanel">
          <div class="chat-header">
            <span>ëŒ€ì¶œ ìƒë‹´</span>
            <button id="closeChat" style="background:none;border:none;font-size:18px;cursor:pointer;">Ã—</button>
          </div>

          <div class="chat-body" id="chatBody">
            <div class="msg ai">ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?></div>
          </div>

          <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <button id="sendChat">ì „ì†¡</button>
          </div>
        </div>



      </div>
    </div>
  </div>

  <script src="../static/chat.js"></script>
  <script>

    let selectedRateType = "";

    function setAmount(v) {
      document.getElementById('loanAmount').value = v;
    }

    // ê¸ˆë¦¬ ë²„íŠ¼ í´ë¦­ ì‹œ ì„ íƒ ê¸°ëŠ¥
    document.querySelectorAll('.rate-options button').forEach(btn => {
     btn.addEventListener('click', () => {
       // ëª¨ë“  ë²„íŠ¼ active ì œê±°
       document.querySelectorAll('.rate-options button').forEach(b =>
         b.classList.remove('active')
       );

       btn.classList.add('active');
       selectedRateType = btn.dataset.value;
     });
    });

    async function submitPage1() {
      const loanAmount = document.getElementById("loanAmount").value;
      const repaymentPeriod = document.getElementById("repaymentPeriod").value;

      if (!loanAmount) {
        alert("ëŒ€ì¶œ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
        return;
      }
      if (!repaymentPeriod) {
        alert("ìƒí™˜ ê¸°ê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”");
        return;
      }

      if (!selectedRateType) {
            alert("ê¸ˆë¦¬ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”");
            return;
      }

      const payload = {
        loanAmount: loanAmount,
        repaymentPeriod: repaymentPeriod,
        rateType: selectedRateType
      };

      // FastAPI ìš”ì²­
      await fetch("/api/page1", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      // ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™
      window.location.href = "/page2";
    }
  </script>

</body>
</html>
